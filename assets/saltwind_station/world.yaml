world:
  title: "The Saltwind Station"
  start: beach
  initial_inventory: [bone]
  initial_companions: []
  intro_text: >
    The research station has always called to you.
    
    Perhaps today you will unlock its secrets.

ai_guidance:
  image_generation: Charcoal drawing, rough texture, expressive strokes, dramatic shading

flags:
  - lighthouse_open
  - power_restored

items:
  journal:
    name: Weathered Journal
    location_description: You can just make out an old weathered journal poking out of the sand.
    description: A leather-bound journal swollen with seawater. Several pages are still readable.
    aliases: [journal, book, diary]
    portable: true

  brass_whistle:
    name: Brass Whistle
    location_description: On the floor you spy a small white whistle.
    description: A small whistle engraved with a wave symbol. It looks well-used.
    aliases: [whistle, brass whistle]
    portable: true

  station_key:
    name: Station Key
    location_description: On the desk is a thick iron key.
    description: A heavy iron key tagged "ADMIN".
    aliases: [key, station key]
    portable: true

  radio:
    name: Shortwave Radio
    description: A battered radio with cracked dials. It hums faintly when powered.
    portable: false
    aliases: [radio]

  generator:
    name: Backup Generator    
    location_description:
      - text: The generator chugs away steadily.
        criteria: { requires_flags: [ power_restored ] }
      - The generator sits silent.
    description: A diesel generator bolted to the concrete floor.
    portable: false
    aliases: [generator]

  fuel_can:
    name: Fuel Can
    location_description: An old metal fuel can sits in the corner.
    description: A half-full jerry can that smells strongly of diesel.
    aliases: [fuel, diesel, can, fuel can]
    portable: true

  lighthouse_door:
    name: Lighthouse Door
    description: A rusted steel door leading into the lighthouse tower.
    portable: false
    aliases: [door, lighthouse door]

  researcher:
    name: Elias the Researcher
    location_description: Elias, a man in a faded field jacket, stands nearby, jotting notes and watching the sea with a wary expression.
    description: A tired man in a faded field jacket, eyes sharp despite the years.
    aliases: [elias, researcher, man]

  caretaker:
    name: Mara the Caretaker
    location_description: Mara, the station's caretaker, lingers near the lighthouse, her attention fixed on the horizon as if expecting the sea to answer back.
    description: A woman with windburned skin and steady hands. She watches the sea constantly.
    aliases: [mara, caretaker, woman]

  bone:
    name: Rubber bone
    portable: true
    description: A small rubber toy bone.
    aliases: [bone]

  dog:
    name: Small dog
    location_description: A small hairy dog sits in an old basket, watching you hopefully.
    description: A small, friendly dog.
    aliases: [dog]

npcs:
  researcher:
    persona: Analytical, guarded, quietly regretful.
    sample_lines:
      - "We were meant to observe, not interfere."
      - "The sea remembers things we try to forget."
    quest_hook: He hints that the station's final broadcast was never sent.
    dialog: Elias rubs his temples. "We picked something up out there. Then command told us to stay quiet."

  caretaker:
    persona: Practical, blunt, deeply attached to the station.
    sample_lines:
      - "Someone has to keep the lights working."
      - "Storm's coming. Always does."
    quest_hook: She wants the lighthouse restored.
    dialog:
      - text: Mara nods as the lights come back on. "Good. Maybe the sea will forgive us yet."
        criteria:
          requires_flags: [ power_restored ]
      - Mara seems preoccupied, and doesn't answer.

  dog:
    persona: A small enthusiastic dog.
    dialog: "\"Woof!\""

locations:
  beach:
    name: Shingle Beach
    description: Waves roll in under a grey sky. Driftwood and old equipment litter the shore.
    items: [journal]
    exits:
      north:
        to: station_yard
        description: A gravel path leading up toward the research station.

  station_yard:
    name: Station Yard
    description: Cracked concrete surrounded by low buildings streaked with salt.
    items: [researcher]
    exits:
      south:
        to: beach
        description: Back down to the beach.
      east:
        to: generator_room
        description: A squat building marked "POWER".
      north:
        to: main_hall
        description: Double doors hang open, creaking in the wind.

  generator_room:
    name: Generator Room
    description: The air smells of oil and rust, with a large diesel generator in the corner of the room.
    items: [generator, fuel_can]
    exits:
      west:
        to: station_yard
        description: Back to the yard.

  main_hall:
    name: Main Hall
    description: Peeling maps of ocean currents cover the walls.
    exits:
      south:
        to: station_yard
        description: Out to the yard.
      east:
        to: radio_room
        description: A narrow hallway lined with cables.
      north:
        to: lighthouse_base
        description: A stone path leading toward the lighthouse.

  radio_room:
    name: Radio Room
    description: Dusty consoles face a single desk-mounted radio.
    items: [radio, station_key, dog]    
    exits:
      west:
        to: main_hall
        description: Back to the main hall.

  lighthouse_base:
    name: Lighthouse Base
    description: The lighthouse looms overhead, paint flaking under the salt air, with a large metal door at the base.
    items: [caretaker, lighthouse_door]
    exits:
      south:
        to: main_hall
        description: Back toward the station.
      up:
        to: lighthouse_top
        description: A spiral staircase inside the lighthouse.
        criteria:
          requires_flags: [lighthouse_open]
        blocked_description: The door to the lighthouse is firmly shut.

  lighthouse_top:
    name: Lighthouse Lantern Room
    description: Glass panes look out over the endless sea. The light is dark.
    items:
      - brass_whistle
    exits:
      down:
        to: lighthouse_base
        description: Back down the spiral stairs.

interactions:
  fuel_generator:
    verb: use
    item: fuel_can
    target: generator
    message: The generator sputters, then roars to life. Lights flicker on across the station.
    repeatable: false
    effect:
      set_flags: [power_restored]

  unlock_lighthouse_door:
    verb: use
    item: station_key
    target: lighthouse_door
    criteria:
      requires_flags: [power_restored]
    message: The key turns with a metallic groan. The lighthouse door unlocks. Inside a spiral stairway leads upward.
    effect:
      set_flags: [lighthouse_open]

  try_open_lighthouse_door:
    verb: open
    item: lighthouse_door
    message: The door is locked, and will not open.

  try_unlock_lighthouse_door_no_power:
    verb: use
    item: station_key
    target: lighthouse_door
    criteria:
      blocking_flags: [power_restored]
    message: The key appears to fit, but the door is too heavy to open manually.

  use_radio:
    verb: use
    item: radio
    criteria:
      requires_flags: [power_restored]
    message: >
      Static clears, replaced by a repeating signal - coordinates, looping endlessly.
      Someone is still listening.

  try_use_radio_no_power:
    verb: use
    item: radio
    criteria:
      blocking_flags: [power_restored]
    message: >
      The radio is dead.

  give_bone_to_dog:
    verb: give
    item: bone
    target: dog
    consumes: true
    message: The dog accepts the toy bone and begins chewing on it.
    effect: { add_companions: [dog] }
  
  use_whistle:
    verb: use
    item: brass_whistle
    repeatable: true
    message: 
      - text:
          The whistle makes a loud piercing sound, causing the dog to look up.
        criteria: { requires_companions: [dog] }
      - The whistle makes a loud piercing sound. Nothing else happens.
